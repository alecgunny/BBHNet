Bootstrap: docker
From: python:3.10.12-slim-bullseye
Stage: build

%files
. /opt/aframe/aframe/train
../pipelines /opt/aframe/aframe/pipelines
../utils /opt/aframe/aframe/utils
../../ml4gw /opt/aframe/ml4gw
../../hermes /opt/aframe/hermes

%post
# TODO: install is breaking with virtualenv version,
# so could be worthwhile to start doing this install
# inside the virtualenv again. Or can we just pip
# install? I forget exactly why we use poetry
python -m pip install poetry virtualenv==20.4.7
poetry config virtualenvs.create false
cd /opt/aframe/aframe/train
poetry install
